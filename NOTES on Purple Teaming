NTLM authentication
  Responder uses thre main protocols to connect/authenticate: NetBIOS Name Server (NBT-NS), Link-Local Multicast Name Resolution (LLMNR), Multicast DNS (mDNS)
  Responder used inside network lateral movement
  Responder captures challenge/response 
RPC methods to execute API calls on remote machine (ex. \\<ip>\share\file.txt)  #no special permissions needed
  Coercer and PetitPotam for RPC
Can coerce witih IPv6
  Assign target system IPv6 addr in link-local range
  MiTM6, will listen and reply to DHCPv6 messages 
  W/O PARAMETERS, MiTM6 WILL TARGET EVERY SYSTEM AND DOMAIN ON NETWORK
SMB Coerce
  Embed hosted SMB share picture in word documet (ex. ctrl f9, {IMPORT\\\\<ip>\\image.jpeg})
  responder listens on target IP
  DISABLE OUBOUND SMB
NTLM relays
  Can sit in between and relay requests, challenge, and authentication
Crack NTLM challenge/response
  hashcat -m 5600 hash.txt password_list.txt -o cracked.txt
  hash.txt is the hash to crack, the password list can be changed, possibly develop your own.
  LONG COMPLEX PASSWORDS
Defending against these attacks
  NBT-NS, LLMNR, and mDNS be DISABLED
  SMB signing prevents relay attacks, use group policy (may result in reduced performance of 15%
  Use private VLANS (communication to router, no lateral communication)
Phishing
  Email bombing, lotsa spam then an IT support email (fake)
  CAPTCHA, you think you are clicking a captcha, really its a powershell command being copied to your clipboard
  MFA bombing, user gets fatigued from amount of MFA, eventually request is approved
  Watering hole, compromised website, exploit kits
Users in Phishing
  Make sure users are aware of security posture/needs
Email/Browser Phishing Security
  SPF + DKIM provide an email check, if the mail fails, the DMARC steps in to apply policies for failed authentication
  Sender Verification: suspicious anomalies bassed on sender's identity
  Safe Links: Links are checked
  Safe Attachments: Attachments are checked, multiple settings like dynamic delivery or monitor
  Zero Hour auto Purge: retroactively detects and removes messages already in mailbox
  Microsoft Defender for Endpoint SmartScreen: Real time reuptation checks, browser integration, configurable for Enterprise
EvilGinx
  Acts as reverse proxy for website
  use U2F or FIDO2, needs username and password

Windows Script Host: implemented in cscript.exe and wscript.exe, native execution of scripts
  secure by, disable the WSH "HKCU\Software\Microsoft\Windows Script HOsting\Settings
  Remove or block access to wscript.exe and cscript.exe (application control policies)
  Disable global VBSscript or JScript support, deregister ActiveX components
HTML Application (HTA): source code is dynamic (HTML) and one or more scripting languages supported by edge
  Use mshta.exe to run (not constrained by browser security controls)
  NCC Group created encrypted HTAs (Demiguise) Tries to evade AV detection, needs environmental key to run
  SECURE by blocking mshta.exe through AppLocker/Windows Defender Application Control; Use Attack Surface Reduction (ASR) rules to prevent execution
PREVENT QUICK CLICKING
  1. Group Policy Editor
  2. Select OU with computers to apply default associations
  3. Create and edit new GPO
  4. Go to Computer Config -> admin templates -> windows components -> file explorer
  5. Select "Set a default associations configuration file."
  6. Enable policy and specify UNC path to default association XML file (in SYSVOL)
  7. Run gpupdate
VBA: similar to .vbs, much more powerful
  different engine than WSH, dialect of Visual Basic that is NOT VBScript
  PROTECTION BY Turn on Protected View
  Lots of Macro Restrictions can be configured
  VBA MACRO SETTINGS Microsoft OFfice Trust Center
USE MARK OF THE WEB TO EXAMINE ZONE IDENTIFIER
  
